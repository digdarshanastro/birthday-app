<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Digdarshan Dashboard</title>
<link rel="stylesheet" href="style.css">
<style>
/* small admin overrides to ensure layout matches add.html look */
.container { max-width:1400px; margin:20px auto; padding:20px; border-radius:12px; }
.header-top { text-align:center; margin-bottom:8px; position:relative; z-index:2; }
.header-top img { width:72px; height:72px; object-fit:contain; border-radius:12px; display:inline-block; vertical-align:middle; margin-right:10px; }
.header-title { display:inline-block; vertical-align:middle; text-align:left; }
.header-title h1 { margin:0; font-size:22px; color:#ffd6e8; }
.header-title .sub { font-weight:700; color:rgba(255,255,255,0.85); font-size:13px; margin-top:6px; }
.controls { display:flex; gap:12px; justify-content:center; align-items:center; margin:8px 0 12px; flex-wrap:wrap; z-index:2; position:relative; }
#searchBar{width:68%; min-width:260px}
.table-box{overflow:auto; margin-top:12px; z-index:2; position:relative;}
table{width:100%; border-collapse:collapse}
th, td { padding:10px 8px; border:1px solid rgba(255,255,255,0.03); font-size:13px; white-space:nowrap; text-align:center; vertical-align:middle; }
th { background:rgba(255,255,255,0.02); color:#ffe3f0; font-weight:800; }
.actions-line { display:flex; gap:8px; align-items:center; justify-content:center; flex-wrap:nowrap; }
.actions-line.two { margin-top:8px; justify-content:center; }
.action-btn { min-width:72px !important; height:34px; display:inline-flex; align-items:center; justify-content:center; border-radius:8px; font-weight:800; font-size:12px; text-decoration:none; color:#fff; padding:6px 8px; }
.card-btn{background:#ff4500}
.whatsapp-btn{background:#25d366;color:#05260f}
.icon-vert{display:flex;flex-direction:column;gap:8px;align-items:center;margin-left:8px}
.icon-vert span{display:inline-block;width:36px;height:34px;background:transparent;border-radius:6px;line-height:34px;text-align:center;cursor:pointer}
.icon-vert .edit{color:#ffb86b}
.icon-vert .del{color:#ff5b6b}
.row-blink{animation:softBlink 1.5s infinite}
@keyframes softBlink{0%{opacity:1}50%{opacity:0.45}100%{opacity:1}}
@media(max-width:980px){
  #searchBar{width:92%}
  th,td{font-size:12px;padding:8px}
}
@media(max-width:640px){
  th,td{font-size:11px;padding:8px;white-space:normal}
  .actions-line, .actions-line.two{justify-content:flex-start;flex-wrap:wrap}
  .icon-vert{flex-direction:row}
  .icon-vert span{width:auto;height:28px;padding:0 8px;line-height:28px}
}
</style>
</head>
<body>

<div class="container" role="main">
  <div class="header-top">
    <img src="Digdarshan Astro Logo.png" alt="logo">
    <div class="header-title" aria-hidden="true">
      <h1>Digdarshan Dashboard</h1>
      <div class="sub">Jyotish Devagya Amitsree â€” Call: 8697190840 / 9830637766</div>
      <div style="margin-top:6px;"><a href="https://digdarshanastro.mydurable.com/" target="_blank" style="color:#ffd2ee;text-decoration:underline;">https://digdarshanastro.mydurable.com/</a></div>
    </div>
  </div>

  <div class="controls">
    <div id="counterBox" style="font-weight:800;color:#ffe3f0;background:rgba(255,255,255,0.02);padding:8px 12px;border-radius:8px;"></div>
    <input id="searchBar" placeholder="Search by Name / Mobile / DOB / PIN / City / Consult Type / Remedies / Notes / Gotra...">
    <div id="upcomingAlert" class="alert-box" style="display:none;"></div>
  </div>

  <div class="table-box" aria-live="polite">
    <table id="tbl" role="table" aria-label="Saved details table">
      <!-- rows injected by JS -->
    </table>
  </div>
</div>

<!-- Edit Modal -->
<div id="editModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:9999; align-items:center; justify-content:center;">
  <div style="width:95%;max-width:820px;background:linear-gradient(180deg,#141018,#1f1724);padding:18px;border-radius:12px;box-shadow:0 10px 50px rgba(0,0,0,0.8);">
    <h3 style="color:#fff;margin:6px 0 8px;">Edit Record</h3>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
      <input id="e_name" placeholder="Name">
      <input id="e_mobile" placeholder="Mobile (10 digits)">
      <input id="e_email" placeholder="Email">
      <input id="e_dob" type="date" placeholder="DOB">
      <input id="e_time" type="time" placeholder="Time">
      <input id="e_place" placeholder="Place">
      <input id="e_gotra" placeholder="Gotra">
      <input id="e_maternal" placeholder="Maternal Uncle's Gotra">
      <input id="e_anniv" type="date" placeholder="Marriage Date">
      <input id="e_pin" placeholder="PIN">
      <input id="e_city" placeholder="City">
      <input id="e_state" placeholder="State">
      <input id="e_country" placeholder="Country">
      <select id="e_consultType"><option value="">Consult Type</option><option>Physical Visit</option><option>Online Consultation</option></select>
      <select id="e_consultMode"><option value="">Consult Mode</option><option>Free Consultation (Offline)</option><option>Paid Consultation</option><option>Premium Consultation (Recommended)</option></select>
      <select id="e_remedies"><option value="">Preferred Remedies</option><option>Gemstone</option><option>Rudraksha</option><option>Tantra/Kavach</option><option>Home-based Remedies (Totka)</option></select>
      <textarea id="e_notes" placeholder="Notes"></textarea>
    </div>

    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
      <button class="btn ghost" onclick="closeEdit()">Cancel</button>
      <button class="btn" onclick="saveEdit()">Save</button>
    </div>
  </div>
</div>

<script type="module">
import { db } from "./firebase-config.js";
import { collection, getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

</script>
</body>
</html>
