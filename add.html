<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Birth Details — Digdarshan Astro</title>

<link rel="stylesheet" href="style.css">

<style>
/* ------------ PAGE BACKGROUND -------------- */
body {
  margin:0;
  font-family: Arial, sans-serif;
  background-image: url('Rashichakra.png');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  background-repeat: no-repeat;
  backdrop-filter: blur(4px);
}

/* GLASS FORM WRAPPER */
.form-wrapper {
  max-width: 900px;
  margin: 40px auto;
  padding: 25px 30px;
  background: rgba(255,255,255,0.07);
  border-radius: 20px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.15);
  box-shadow: 0 0 20px rgba(0,0,0,0.35);
}

/* ---------- BRAND HEADER ---------- */
.brand-block {
  text-align:center;
  margin-bottom:20px;
  color:white;
}

.brand-block img {
  width:90px;
  height:90px;
  object-fit:contain;
}

.brand-title {
  font-size:28px;
  font-weight:900;
  margin-top:10px;
}

.brand-sub {
  font-size:16px;
  margin-top:4px;
  font-weight:600;
}

.brand-link a {
  color:#ffe0f2;
  font-size:15px;
  font-weight:700;
  text-decoration: underline;
}

/* ------------ TITLE ----------- */
.main-title {
  text-align:center;
  font-size:16px;     /* SMALLER as requested */
  font-weight:bold;
  margin-bottom:20px;
  color:#fff;
}

/* ---------- STEPPER ---------- */
.stepper {
  display:flex;
  justify-content:center;
  margin-bottom:25px;
  gap:20px;
}

.step {
  text-align:center;
  cursor:pointer;
  color:#ddd;
  font-weight:700;
}

.step.active .bar {
  background: linear-gradient(90deg,#ff6ea6,#ff9d6d);
}

.step .bar {
  width:140px;
  height:6px;
  border-radius:10px;
  background: rgba(255,255,255,0.25);
  margin-bottom:6px;
}

/* ------------- INPUT STYLING --------------- */
label {
  color:white;
  font-size:14px;
  font-weight:bold;
  margin-top:12px;
  display:block;
}

input, textarea, select {
  width:100%;
  padding:12px;
  margin-top:4px;
  border-radius:12px;
  border:none;
  background: rgba(255,255,255,0.15);
  color:white;
  backdrop-filter: blur(4px);
}

textarea {
  height:100px;
}

.row { display:flex; gap:15px; flex-wrap:wrap; }
.col { flex:1; min-width:240px; }

/* ------------ BUTTONS ------------- */
.btn {
  background: linear-gradient(90deg,#ff6ea6,#ff9d6d);
  padding:12px 28px;
  border-radius:30px;
  border:none;
  font-weight:bold;
  color:white;
  cursor:pointer;
}

.btn-outline {
  background:transparent;
  padding:10px 22px;
  border-radius:25px;
  color:white;
  border:1px solid rgba(255,255,255,0.4);
  cursor:pointer;
}

/* PREVIEW BOX */
.preview-box {
  background: rgba(255,255,255,0.10);
  border-radius:12px;
  padding:12px;
  margin-top:10px;
  color:white;
  line-height:1.5;
}
</style>
</head>

<body>

<div class="form-wrapper">

  <!-- LOGO + COMPANY DETAILS -->
  <div class="brand-block">
    <img src="Digdarshan Astro Logo.png" alt="">
    <div class="brand-title">DIGDARSHAN ASTRO</div>
    <div class="brand-sub">Jyotish Devagya Amitsree — Call: 8697190840 / 9830637766</div>
    <div class="brand-link">
      <a href="https://digdarshanastro.mydurable.com/" target="_blank">
        https://digdarshanastro.mydurable.com/
      </a>
    </div>
  </div>

  <!-- SMALL TITLE -->
  <div class="main-title">Fill Your Birth Details Consultation Type.</div>

  <!-- STEPPER -->
  <div class="stepper">
    <div class="step active" id="s1" onclick="showStep(1)">
      <div class="bar"></div> Client Details
    </div>
    <div class="step" id="s2" onclick="showStep(2)">
      <div class="bar"></div> Birth Details
    </div>
    <div class="step" id="s3" onclick="showStep(3)">
      <div class="bar"></div> Consultation
    </div>
  </div>

  <!-- FORM START -->
  <form id="mainForm">

    <!-- STEP 1 -->
    <div id="step1">

      <div class="row">
        <div class="col">
          <label>First Name</label>
          <input id="fname" required>
        </div>
        <div class="col">
          <label>Last Name</label>
          <input id="lname">
        </div>
      </div>

      <label>Mobile Number</label>
      <div class="row">
        <div class="col" style="max-width:120px;">
          <input value="+91" disabled>
        </div>
        <div class="col">
          <input id="mobile" maxlength="10" minlength="10" placeholder="10-digit number">
        </div>
      </div>

      <label>Email</label>
      <input id="email">

      <label>Address</label>
      <input id="address">

      <div class="row">
        <div class="col">
          <label>City</label>
          <input id="city">
        </div>
        <div class="col">
          <label>State</label>
          <input id="state">
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label>PIN</label>
          <input id="pin">
        </div>
        <div class="col">
          <label>Country</label>
          <input id="country" value="India">
        </div>
      </div>

      <br>
      <center><button type="button" class="btn" onclick="showStep(2)">Next</button></center>

    </div>

    <!-- STEP 2 -->
    <div id="step2" style="display:none;">

      <div class="row">
        <div class="col">
          <label>Date of Birth</label>
          <input type="date" id="dob">
        </div>
        <div class="col">
          <label>Time of Birth</label>
          <input type="time" id="tob">
        </div>
      </div>

      <label>Place of Birth</label>
      <input id="place">

      <label>Gotra</label>
      <input id="gotra">

      <label>Date of Marriage</label>
      <input type="date" id="anniv">

      <br>
      <center>
        <button type="button" class="btn-outline" onclick="showStep(1)">Back</button>
        <button type="button" class="btn" onclick="showStep(3)">Next</button>
      </center>

    </div>

    <!-- STEP 3 -->
    <div id="step3" style="display:none;">

      <label>A. Consultation Type</label>
      <select id="consultType">
        <option value="">Select</option>
        <option>Physical Visit</option>
        <option>Online Consultation</option>
      </select>

      <label>B. Consultation Mode</label>
      <select id="consultMode">
        <option value="">Select</option>
        <option>Free Consultation (offline)</option>
        <option>Paid Consultation</option>
        <option>Premium Consultation (Recommended)</option>
      </select>

      <label>C. Preferred Remedies</label>
      <textarea id="remedies" placeholder="Gemstone, Rudraksha, Kavach, Totka..."></textarea>

      <label>Notes (optional)</label>
      <textarea id="notes"></textarea>

      <div class="preview-box" id="previewBox">Preview will appear here...</div>

      <br>
      <center>
        <button type="button" class="btn-outline" onclick="showStep(2)">Back</button>
        <button type="button" class="btn" onclick="submitForm()">Submit</button>
      </center>

    </div>

  </form>
</div>

<script type="module">
import { db } from "./firebase-config.js";
import { collection, addDoc, serverTimestamp } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* -------------------- STEPS ------------------------ */
function showStep(n) {
  document.getElementById("step1").style.display = (n===1 ? "block" : "none");
  document.getElementById("step2").style.display = (n===2 ? "block" : "none");
  document.getElementById("step3").style.display = (n===3 ? "block" : "none");

  document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
  document.getElementById("s"+n).classList.add("active");
}

/* ------------------- PREVIEW ---------------------- */
function buildPreview() {
  let name = (fname.value + " " + lname.value).trim();

  previewBox.innerHTML =
    "<b>Name:</b> " + name + "<br>" +
    "<b>Mobile:</b> +91 " + mobile.value + "<br>" +
    "<b>Date of Birth:</b> " + dob.value + "<br>" +
    "<b>Consultation Type:</b> " + consultType.value + "<br>" +
    "<b>Consultation Mode:</b> " + consultMode.value + "<br>" +
    "<b>Remedies:</b> " + remedies.value;
}

window.showStep = showStep;

/* ------------------- SUBMIT ----------------------- */
window.submitForm = async function () {

  if (!mobile.value || mobile.value.length !== 10) {
    alert("Enter a 10-digit mobile number");
    return;
  }

  buildPreview();

  const payload = {
    name: (fname.value + " " + lname.value).trim(),
    mobile: "+91 " + mobile.value,
    phone: "+91 " + mobile.value,
    email: email.value,
    address: address.value,
    city: city.value,
    state: state.value,
    country: country.value,
    pin: pin.value,
    dob: dob.value,
    tob: tob.value,
    place: place.value,
    gotra: gotra.value,
    anniv: anniv.value,
    consultType: consultType.value,
    consultMode: consultMode.value,
    remedies: remedies.value,
    notes: notes.value,
    createdAt: serverTimestamp()
  };

  try {
    await addDoc(collection(db, "birth_details"), payload);
    alert("Details Saved Successfully!");
    location.reload();
  }
  catch(e){
    alert("Failed to save. Check Firebase rules.");
    console.error(e);
  }
};
</script>

</body>
</html>
